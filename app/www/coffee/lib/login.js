// Generated by CoffeeScript 1.9.1
(function() {
  define(['strings', 'storage', 'utils', 'api', 'nav', 'css'], function(strings, storage, utils, api, nav, css) {
    var _loadPage, _nav, _preloadPage, _refreshPage, _registerEvents;
    _nav = void 0;
    _preloadPage = function() {
      return _registerEvents();
    };
    _loadPage = function(params) {
      return console.log("load");
    };
    _refreshPage = function() {
      return console.log("refresh");
    };
    _registerEvents = function() {
      $('#login-btn').click(function(event) {
        var email, password;
        email = $('#login-email-input').val();
        password = $('#login-password-input').val();
        return api.authenticateUser(email, password, function(json) {
          if (json['success']) {
            storage.setLanguage('fr');
            return api.ensureDictionary('fr', function(json) {
              if (json['success']) {
                return _nav.loadPage('overview');
              } else {
                return $('#login-error').html(strings.getString('unexpectedFailure'));
              }
            });
          } else {
            return $('#login-error').html(strings.getString('loginFailed'));
          }
        });
      });
      return $('#login-signup-btn').click(function(event) {
        return _nav.loadPage('signup');
      });
    };
    return {
      preloadPage: function() {
        _nav = require('nav');
        return _preloadPage();
      },
      refreshPage: function() {
        return _refreshPage();
      },
      loadPage: function(params) {
        return _loadPage(params);
      }
    };
  });

}).call(this);
